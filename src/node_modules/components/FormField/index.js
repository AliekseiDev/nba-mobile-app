import React from 'react';

import serializeFormData from './serializeFormData';
import updateFormData from './updateFormData';
import validateFormData from './validateFormData';

const FormField = ({update, data, onChange, onBlur, onFocus, ...rest}) => {
  let template = null;
  let newData = {...data};
  
  let onChangeHandler = (e) => {
    
    newData.value = e.target.value;
    update(newData);
    onChange && onChange(e);
  }

  let onBlurHandler = (e) => {
    
    newData.active = false;
    update(newData);
    onBlur && onBlur(e);
  }

  let onFocusHandler = (e) => {
    
    newData.touched = true;
    newData.active = true;
    update(newData);
    onFocus && onFocus(e);
  }

  
  switch(data.element) {
    case 'input':
      template = (
        <input 
          value={data.value}
          {...data.attrs}
          onChange={onChangeHandler}
          onBlur={onBlurHandler}
          onFocus={onFocusHandler}
          {...rest}
        />
      );
      break;

    case 'select':
      template = (
        <select 
          value={data.value}
          {...data.attrs}
          onChange={onChangeHandler}
          onBlur={onBlurHandler}
          onFocus={onFocusHandler}
          {...rest}
        >
          <option value="">Choose a team</option>
          {data.options.map((item, i) => (
            <option value={item.teamId} key={i}>{item.city}</option>
          ))}
        </select>
      );
      break;

    default:
      template = null;
  }

  return template;
};

export default FormField;

export {
  serializeFormData,
  updateFormData,
  validateFormData
}